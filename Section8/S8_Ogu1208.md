# ë‹¤ì–‘í•œ ì˜ì¡´ê´€ê³„ ì£¼ì… ë°©ë²•
## ìƒì„±ì ì£¼ì…
ìƒì„±ìë¥¼ í†µí•´ ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì… ë°›ëŠ” ë°©ë²•ìœ¼ë¡œ, ìƒì„±ì í˜¸ì¶œ ì‹œì ì— **ë”± 1ë²ˆë§Œ í˜¸ì¶œ**ë˜ëŠ” ê²ƒì´ ë³´ì¥ëœë‹¤.
**ë¶ˆë³€, í•„ìˆ˜** ì˜ì¡´ê´€ê³„ì— ì‚¬ìš©í•œë‹¤.

``` java
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
}
```
**ìƒì„±ìê°€ 1ê°œë§Œ ìˆìœ¼ë©´ `@Autowired`ë¥¼ ìƒëµí•´ë„ ìë™ ì£¼ì… ëœë‹¤.**
ìŠ¤í”„ë§ì€ ì›ë˜ ëª¨ë“  ë¹ˆì„ ë“±ë¡í•œ í›„ ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì…í•˜ì§€ë§Œ, ìƒì„±ì ì£¼ì…ì˜ ê²½ìš° ì–´ì©” ìˆ˜ ì—†ì´ ë¹ˆ ë“±ë¡ë‹¨ê³„ì—ì„œ ê°™ì´ ì£¼ì…í•œë‹¤.

## ìˆ˜ì •ì ì£¼ì…(setter ì£¼ì…)
Setterë¥¼ í†µí•´ í•„ë“œì˜ ê°’ì„ ë³€ê²½í•˜ëŠ” ìˆ˜ì •ì ë©”ì„œë“œë¡œ ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì…í•œë‹¤.
**ì„ íƒ, ë³€ê²½** ê°€ëŠ¥ì„±ì´ ìˆëŠ” ì˜ì¡´ê´€ê³„ì—ì„œ ì‚¬ìš©í•œë‹¤.

``` java
public class OrderServiceImpl implements OrderService{

    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;

    @Autowired
    public void setMemberRepository(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    @Autowired
    public void setDiscountPolicy(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }
}
```

> @Autowiredì˜ ê¸°ë³¸ ë™ì‘ì€ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë¯€ë¡œ, ì£¼ì…í•  ëŒ€ìƒì´ ì—†ì–´ë„ ë™ì‘í•˜ê²Œ í•˜ê¸° ìœ„í•´ì„œëŠ” `@Autowired(required=false)` ì˜µì…˜ì„ ì§€ì •í•œë‹¤.

## í•„ë“œ ì£¼ì…
í•„ë“œì— ë°”ë¡œ ì£¼ì…í•˜ëŠ” ë°©ì‹ì´ì§€ë§Œ ì•„ë˜ì™€ ê°™ì€ ë§ì€ ë‹¨ì ë“¤ì´ ìˆìœ¼ë‹ˆ ì‚¬ìš©ì„ ì§€ì–‘í•˜ì.
- ì™¸ë¶€ì—ì„œ ë³€ê²½ì´ ë¶ˆê°€ëŠ¥í•˜ì—¬ ìˆœìˆ˜ ìë°”ì½”ë“œë¡œ í…ŒìŠ¤íŠ¸í•˜ê¸° ì–´ë µë‹¤.
  - ê°€ì§œ ëª©ê°ì²´ í…ŒìŠ¤íŠ¸ê°€ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ê°€ì§œë¡œ ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì…í•´ì£¼ê¸° ìœ„í•´ì„œëŠ” ë”°ë¡œ setterë¥¼ ë§Œë“¤ì–´ ì£¼ì…í•´ì£¼ì–´ì•¼ í•˜ëŠ”ë°, ê·¸ëŸ´ ë°”ì—” ì°¨ë¼ë¦¬ setterì£¼ì…ì´ ë‚«ë‹¤.
- DI í”„ë ˆì„ì›Œí¬ê°€ ì—†ìœ¼ë©´ ì•„ë¬´ê²ƒë„ í•  ìˆ˜ ì—†ë‹¤.
- í•œì •ì ì¸ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ë˜ëŠ” ìŠ¤í”„ë§ ì„¤ì • ëª©ì ì˜ @Configuration ê°™ì€ ê³³ì—ì„œë§Œ íŠ¹ë³„í•œ ìš©ë„ë¡œ ì‚¬ìš©í•˜ì.

``` java
@Component
public class OrderServiceImpl implements OrderService{
    @Autowired private MemberRepository memberRepository;
    @Autowired private DiscountPolicy discountPolicy;
}
```

## ì¼ë°˜ ë©”ì„œë“œ ì£¼ì…
ì¼ë°˜ ë©”ì„œë“œë¥¼ í†µí•´ì„œ ì£¼ì…ë°›ëŠ”ë‹¤.
ìƒì„±ìì™€ ê°™ì´ í•œ ë²ˆì— ì—¬ëŸ¬ í•„ë“œë¥¼ ì£¼ì…ë°›ì„ ìˆ˜ë„ ìˆëŠ”ë°, ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.


> ì˜ì¡´ê´€ê³„ ìë™ ì£¼ì…ì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ê´€ë¦¬í•˜ëŠ” ìŠ¤í”„ë§ ë¹ˆì´ì–´ì•¼ í•œë‹¤.

# ì˜µì…˜ ì²˜ë¦¬
ì£¼ì…í•  ìŠ¤í”„ë§ ë¹ˆì´ ì—†ì–´ë„ ë™ì‘í•´ì•¼í•  ê²½ìš° ì˜µì…˜ì²˜ë¦¬ë¥¼ í†µí•´ ë™ì‘í•˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤.
- `@Autowired(required=false)` : ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ ìˆ˜ì •ì ë©”ì„œë“œ í˜¸ì¶œì´ ë˜ì§€ ì•ŠëŠ”ë‹¤.
- `org.springframework.lang.@Nullable` : ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ Nullì´ ì…ë ¥ëœë‹¤.
- `Optional<>` : ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ Optional.emptyê°€ ì…ë ¥ëœë‹¤.

# ìƒì„±ì ì£¼ì…ì„ ì„ íƒí•´ë¼!
ìµœê·¼ì—ëŠ” DI í”„ë ˆì„ì›Œí¬ ëŒ€ë¶€ë¶„ì´ ìƒì„±ì ì£¼ì…ì„ ê¶Œì¥í•œë‹¤.

## ë¶ˆë³€
- ëŒ€ë¶€ë¶„ì˜ ì˜ì¡´ê´€ê³„ ì£¼ì…ì€ í•œ ë²ˆ ì¼ì–´ë‚˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œì‹œì ê¹Œì§€ ì˜ì¡´ê´€ê³„ë¥¼ ë³€ê²½í•  ì¼ì´ ì—†ë‹¤.
- ìˆ˜ì •ì ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´ setXXX ë©”ì„œë“œë¥¼ publicìœ¼ë¡œ ì—´ì–´ë‘ì–´ ë³€ê²½ì´ ì˜ë„ì¹˜ ì•Šê²Œ ì¼ì–´ë‚  ìˆ˜ ìˆë‹¤.
- ìƒì„±ì ì£¼ì…ì€ ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ë”± 1ë²ˆë§Œ í˜¸ì¶œë˜ë¯€ë¡œ ì´í›„ì— í˜¸ì¶œë˜ëŠ” ì¼ì´ ì—†ë‹¤. ë”°ë¼ì„œ ë¶ˆë³€ìœ¼ë¡œ ì„¤ê³„ê°€ ê°€ëŠ¥í•˜ë‹¤.

## setter ì£¼ì… - ìˆœìˆ˜ ìë°” ì½”ë“œ í…ŒìŠ¤íŠ¸
`@Autowired`ê°€ í”„ë ˆì„ì›Œí¬ ì•ˆì—ì„œ ë™ì‘í•  ë•ŒëŠ” ì˜ì¡´ê´€ê³„ê°€ ì—†ìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ë§Œ, ì•„ë˜ì™€ ê°™ì´ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•  ê²½ìš° `NPEê°€ ë°œìƒí•œë‹¤.
``` java
@Component
public class OrderServiceImpl implements OrderService{

    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;

    @Autowired
    public void setMemberRepository(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    @Autowired
    public void setDiscountPolicy(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }
}
```

```java
package hello.core.order;

import org.junit.jupiter.api.Test;

public class OrderServiceImplTest {

    @Test
    void createOrder() {
        OrderServiceImpl orderService = new OrderServiceImpl();
        orderService.createOrder(1L, "itemA", 10000);
    }
}
```

ìˆœìˆ˜ ìë°” í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œëŠ” setterì£¼ì…ì€ DIì»¨í…Œì´ë„ˆê°€ ë™ì‘í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, memberRepository, discountPolicy ëª¨ë‘ ì˜ì¡´ê´€ê³„ ì£¼ì…ì´ ëˆ„ë½ë˜ì—ˆê¸° ë•Œë¬¸ì´ë‹¤.
ë”°ë¼ì„œ ì§ì ‘ ê°ì²´ë¥¼ ìƒì„±í•˜ì—¬ ì£¼ì…í•´ì£¼ì–´ì•¼ í•œë‹¤.

## final í‚¤ì›Œë“œ
ìƒì„±ì ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´ í•„ë“œì— final í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ìƒì„±ì ì£¼ì…ì´ ì•„ë‹ˆë¼ë©´ final í‚¤ì›Œë“œê°€ ë¶ˆê°€ëŠ¥í•˜ë‹¤.(ë‚˜ë¨¸ì§€ ì£¼ì… ë°©ì‹ì€ ê°ì²´ê°€ ìƒì„±ëœ ë‹¤ìŒ í˜¸ì¶œë˜ê¸° ë•Œë¬¸)
ë”°ë¼ì„œ ìƒì„±ìì— ì˜ì¡´ê´€ê³„ê°€ ì„¤ì •ë˜ì§€ ì•Šì„ ë•Œ ì»´íŒŒì¼ ì˜¤ë¥˜ê°€ ë‚œë‹¤.
ì»´íŒŒì¼ ì˜¤ë¥˜ëŠ” ê°€ì¥ ë¹ ë¥´ê³  ì¢‹ì€ ì˜¤ë¥˜ì´ë‹¤.

# ë¡¬ë³µê³¼ ìµœì‹  íŠ¸ë Œë“œ
ìµœê·¼ì—ëŠ” ìƒì„±ìë¥¼ ë”± 1ê°œë§Œ ë‘ê³ , `@Autowired`ë¥¼ ìƒëµí•˜ëŠ” ë°©ë²•ì„ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤.
ë˜í•œ `@RequiredArgsConstructor`ë¥¼ ì‚¬ìš©í•´ final í‚¤ì›Œë“œê°€ ë¶™ì€ í•„ë“œë¥¼ ëª¨ì•„ ìƒì„±ìë¥¼ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì£¼ëŠ” ë¡¬ë³µì„ í™œìš©í•œë‹¤.

``` java
/**Before Case**/
@Component
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
}

/**After Case**/
@Component
@RequiredArgsConstructor
@Getter
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;
}
```
## ì¡°íšŒ ë¹ˆì´ 2ê°œ ì´ìƒ
**`@Autowired`ëŠ” íƒ€ì…(Type)ìœ¼ë¡œ ì¡°íšŒí•œë‹¤.**
ë”°ë¼ì„œ `ac.getBean(DiscountPolicy.class)`ì™€ ë¹„ìŠ·í•˜ê²Œ ë™ì‘í•˜ëŠ”ë°, ê°™ì€ íƒ€ì…ì´ 2ê°œ ì´ìƒ ì¡°íšŒë  ê²½ìš° `NoUniqueBeanDefinitionException`ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.

``` java
NoUniqueBeanDefinitionException: No qualifying bean of type 'hello.core.discount.DiscountPolicy' available: expected single matching bean but found 2: fixDiscountPolicy,rateDiscountPolicy
```

# @Autowired í•„ë“œ ëª…, @Qualifier, @Primary
ì¡°íšŒ ëŒ€ìƒ ë¹ˆì´ 2ê°œ ì´ìƒì¼ ê²½ìš° í•´ê²°í•˜ëŠ” ë°©ë²•ë“¤ì´ë‹¤.

## @Autowired í•„ë“œëª…
1. `@Autowired`ëŠ” ìš°ì„  ê¸°ë³¸ ë™ì‘ì¸ íƒ€ì… ë§¤ì¹­ì„ ì‹œë„í•˜ê³ ,
2. **ì—¬ëŸ¬ ë¹ˆì´ ìˆìœ¼ë©´ í•„ë“œ ì´ë¦„, íŒŒë¼ë¯¸í„° ì´ë¦„ìœ¼ë¡œ ë¹ˆ ì´ë¦„ì„ ì¶”ê°€ ë§¤ì¹­**í•œë‹¤.

ì•„ë˜ì™€ ê°™ì´ í•„ë“œ ëª…ì„ ìì‹íƒ€ì…ìœ¼ë¡œ ëª…ì‹œí•˜ë©´ RateDiscountPolicyê°€ ì£¼ì…ëœë‹¤.

``` java
public class AutoAppConfigTest {

		@Autowired
    //private DiscountPolicy discountPolicy;
		private DiscountPolicy rateDiscountPolicy;

    ...
}
```

## @Qualifier
`@Qualifier`ëŠ” ì¶”ê°€ êµ¬ë¶„ìë¥¼ ë¶™ì—¬ì£¼ëŠ” ë°©ë²•ì´ë‹¤.
ì¶”ê°€ì ìœ¼ë¡œ êµ¬ë¶„í•  ë„¤ì´ë°ì„ ì§“ëŠ” ê²ƒ ë¿, ë¹ˆ ì´ë¦„ì„ ë³€ê²½í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤.

``` java
@Component
@Qualifier("mainDiscountPolicy")
public class RateDiscountPolicy implements DiscountPolicy {}

@Component
@Qualifier("myDiscountPolicy")
public class FixDiscountPolicy implements DiscountPolicy {}

// ìƒì„±ì ì£¼ì…
@Component
@RequiredArgsConstructor
public class OrderServiceImpl implements OrderService {

    private final MemberRepository memberRepository;
    @Qualifier("mainDiscountPolicy")
    private final DiscountPolicy discountPolicy;

		...
}
```

ë§Œì•½ í•´ë‹¹ Qualifierë¡œ ëª»ì°¾ì„ ê²½ìš°, í•´ë‹¹ ì´ë¦„ì˜ ìŠ¤í”Œì´ ë¹ˆì„ ì¶”ê°€ë¡œ ì°¾ëŠ”ë‹¤. í•˜ì§€ë§Œ @QualifierëŠ” @Qualifierë¥¼ ì°¾ëŠ” ìš©ë„ë¡œë§Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

1. `@Qualifier`ë¼ë¦¬ ë§¤ì¹­
2. ë¹ˆ ì´ë¦„ ë§¤ì¹­
3. NoSuchBeanDefinitionException ì˜ˆì™¸ ë°œìƒ

## @Primary
ìš°ì„ ìˆœìœ„ë¥¼ ì •í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ, `@Autwired` ì‹œì— ì—¬ëŸ¬ ë¹ˆì´ ë§¤ì¹­ë„ë˜ë©´ `@Primary`ê°€ ìš°ì„ ê¶Œì„ ê°€ì§„ë‹¤.
``` java
/**FixDiscountPolicy.class**/
@Component
public class FixDiscountPolicy implements DiscountPolicy{
	...
}

/**RateDiscountPolicy.class**/
@Component
@Primary
public class RateDiscountPolicy implements DiscountPolicy{
	...
}

public class AutoAppConfigTest {
    @Autowired
    private DiscountPolicy discountPolicy;

    ...
}
```

### @Primary, @Qualifier í™œìš©
ìì£¼ ì‚¬ìš©í•˜ëŠ” ë¹ˆì— `@Primary`ë¥¼ ì ìš©í•´ `@Qualifier` ì§€ì • ì—†ì´ í¸í•˜ê²Œ ì‚¬ìš©í•˜ê³ , ì„œë¸Œë¡œ ì‚¬ìš©í•˜ëŠ” DBì™€ ê°™ì€ ë¹ˆì— `@Qualifier`ë¥¼ ì§€ì •í•´ ëª…ì‹œì ìœ¼ë¡œ íšë“í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ë©´ ê¹”ë”í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

### ìš°ì„ ìˆœìœ„
ìŠ¤í”„ë§ì€ ìë™ë³´ë‹¤ëŠ” ìˆ˜ë™, ë„“ì€ ë²”ìœ„ë³´ë‹¤ëŠ” ì¢ì€ ë²”ìœ„ì˜ ì„ íƒê¶Œì´ ìš°ì„ ìˆœìœ„ê°€ ë†’ë‹¤.
ë”°ë¼ì„œ `@Primary`ë³´ë‹¤ `@Qualifier`ê°€ ìš°ì„ ìˆœìœ„ê°€ ë†’ë‹¤.

# ì• ë…¸í…Œì´ì…˜ ì§ì ‘ ë§Œë“¤ê¸°
`@Qualifier("mainDiscountPolicy")` ì™€ ê°™ì´ ì¶”ê°€ êµ¬ë¶„ìë¥¼ ì§€ì •í•  ë•Œ, ì´ ì´ë¦„ì€ ë¬¸ìì—´ì´ê¸°ì— ì»´íŒŒì¼ì‹œ íƒ€ì… ì²´í¬ê°€ ì•ˆëœë‹¤. ì¦‰ ì˜¤íƒ€ë¡œ ì¸í•œ ì˜¤ë¥˜ë¥¼ ì»´íŒŒì¼ ì‹œì— ë°œê²¬í•˜ê¸° ì–´ë µë‹¤.
ì´ëŸ´ ê²½ìš° ì• ë…¸í…Œì´ì…˜ì„ ì§ì ‘ ë§Œë“¤ì–´ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

``` java
package hello.core.annotation;

import org.springframework.beans.factory.annotation.Qualifier;
import java.lang.annotation.*;

@Target({ElementType.FIELD, ElementType.METHOD, ElementType.PARAMETER, ElementType.TYPE, ElementType.ANNOTATION_TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Inherited
@Documented
@Qualifier("mainDiscountPolicy")
public @interface MainDiscountPolicy {
}
```
ìœ„ ì• ë…¸í…Œì´ì…˜ì€ í•„ë“œ, ë©”ì„œë“œ, íŒŒë¼ë¯¸í„°, íƒ•ì…, ì• ë…¸í…Œì´ì…˜ íƒ€ì…ì— ëª¨ë‘ ì‚¬ìš© ê°€ëŠ¥í•˜ê³ , ëŸ°íƒ€ì„ ì‹œ ë™ì‘í•œë‹¤.
ë˜í•œ @Qualifier ë™ì‘í•œë‹¤.

ì•„ë˜ì™€ ê°™ì´ ì ìš©í•  ìˆ˜ ìˆë‹¤.
``` java
//ìƒì„±ì ìë™ ì£¼ì…
@Autowired
public OrderServiceImpl(MemberRepository memberRepository,
                        @MainDiscountPolicy DiscountPolicy discountPolicy) {
  this.memberRepository = memberRepository;
  this.discountPolicy = discountPolicy;
}

//ìˆ˜ì •ì ìë™ ì£¼ì…
@Autowired
public DiscountPolicy setDiscountPolicy(@MainDiscountPolicy DiscountPolicy discountPolicy) {
  this.discountPolicy = discountPolicy;
}
```

> ğŸ‹ ì• ë…¸í…Œì´ì…˜ì—ëŠ” ìƒì†ì´ë¼ëŠ” ê°œë…ì´ ì—†ë‹¤. ì—¬ëŸ¬ ê°œì˜ ì• ë…¸í…Œì´ì…˜ì„ ëª¨ì•„ ì‚¬ìš©í•˜ëŠ” ê¸°ëŠ¥ì€ ìŠ¤í”„ë§ì˜ ê¸°ëŠ¥ì´ë‹¤.


# ì¡°íšŒí•œ ë¹ˆì´ ëª¨ë‘ í•„ìš”í•  ë•Œ, List, Map
ì˜ë„ì ìœ¼ë¡œ íŠ¹ì • íƒ€ì…ì˜ ìŠ¤í”„ë§ ë¹ˆì´ ëª¨ë‘ í•„ìš”í•œ ê²½ìš°ë„ ìˆë‹¤.
ex) í• ì¸ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ”ë°, í´ë¼ì´ì–¸íŠ¸ê°€ í• ì¸ì˜ ì¢…ë¥˜(rate, fix)ë¥¼ ì„ íƒí•  ìˆ˜ ìˆë‹¤. 
ì´ëŸ´ ê²½ìš° ìŠ¤í”„ë§ì—ì„œ **ì „ëµ íŒ¨í„´**ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

``` java
package hello.core.autowired;

import hello.core.AutoAppConfig;
import hello.core.discount.DiscountPolicy;
import hello.core.member.Grade;
import hello.core.member.Member;
import org.junit.jupiter.api.Test;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

import java.util.List;
import java.util.Map;

import static org.assertj.core.api.Assertions.assertThat;

public class AllBeanTest {

    @Test
    void findAllBean() {
        ApplicationContext ac = new AnnotationConfigApplicationContext(AutoAppConfig.class, DiscountService.class);
        DiscountService discountService = ac.getBean(DiscountService.class);
        int discount = discountService.discount(new Member(1L, "catsbi", Grade.VIP), 10000, "fixDiscountPolicy");
        assertThat(discount).isEqualTo(1000);
    }

    static class DiscountService {
        private final Map<String, DiscountPolicy> policyMap;
        private final List<DiscountPolicy> policies;

        public DiscountService(Map<String, DiscountPolicy> policyMap, List<DiscountPolicy> policies) {
            this.policyMap = policyMap;
            this.policies = policies;
            System.out.println("policyMap = " + policyMap);
            System.out.println("policyMap = " + policyMap);
        }

        public int discount(Member member, int price, String discountCode) {
            DiscountPolicy discountPolicy = policyMap.get(discountCode);
            System.out.println("discountCode = " + discountCode);
            System.out.println("discountPolicy = " + discountPolicy);

            return discountPolicy.discount(member, price);
        }

    }
}
```

- **DiscountServiceì—ì„œ policyMap, policies í•„ë“œì˜ íƒ€ì…ì´ Map, List ì´ë¯€ë¡œ í•´ë‹¹ ì½œë ‰ì…˜ì˜ ì§€ë„¤ë¦­ íƒ€ì…ì— ë§¤ì¹­ë˜ëŠ” ëª¨ë“  ë¹ˆë“¤ì´ ì£¼ì…ëœë‹¤. **
- ë§Œì•½ í•´ë‹¹í•˜ëŠ” íƒ€ì…ì˜ ìŠ¤í”„ë§ ë¹ˆì´ ì—†ìœ¼ë©´ ë¹ˆ ì»¬ë ‰ì…˜ì´ë‚˜ Mapì„ ì£¼ì…í•œë‹¤.

- discount ë©”ì„œë“œì—ì„œ ì¸ìë¡œ ë°›ì€ discountCodeë¥¼ ìŠ¤í”„ë§ ë¹ˆ ì´ë¦„ìœ¼ë¡œ policyMapì—ì„œ êº¼ë‚´ ê±¸ë§ëŠ” í• ì¸ ì •ì±…ì„ ë°˜í™˜í•˜ê³ , í•´ë‹¹ ì •ì±…ì˜ discount ë©”ì„œë“œë¥¼ í˜¸ì¶œí•œë‹¤. 


# ìë™, ìˆ˜ë™ì˜ ì˜¬ë°”ë¥¸ ì‹¤ë¬´ ìš´ì˜ ê¸°ì¤€
- í¸ë¦¬í•œ ìë™ ê¸°ëŠ¥ì„ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•˜ì
- ì§ì ‘ ë“±ë¡í•˜ëŠ” ê¸°ìˆ  ì§€ì› ê°ì²´ëŠ” ìˆ˜ë™ ë“±ë¡í•˜ì.(ë³´í†µ ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ë°˜ì— ê±¸ì³ ê´‘ë²”ìœ„í•˜ê²Œ ì˜í–¥ì„ ë¯¸ì¹˜ê¸° ë•Œë¬¸ì— ëª…í™•í•˜ê²Œ ë“œëŸ¬ë‚´ëŠ” ê²ƒì´ ìœ ì§€ë³´ìˆ˜ì— ì¢‹ë‹¤.)
- ë‹¤í˜•ì„±ì„ ì ê·¹ í™œìš©í•˜ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ìˆ˜ë™ ë“±ë¡ì„ ê³ ë¯¼í•˜ì.
  - ìë™ìœ¼ë¡œ ë“±ë¡í•  ê²½ìš° íŠ¹ì • ë™ì¼ íŒ¨í‚¤ì§€ì— ë¬¶ì–´ë‘ì.
